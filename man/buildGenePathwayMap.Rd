% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mapping-utils.R
\name{buildGenePathwayMap}
\alias{buildGenePathwayMap}
\title{Build a GenePathwayMap from a data.frame}
\usage{
buildGenePathwayMap(
  mapping,
  feature_genes = NULL,
  min_pathway_size = 5L,
  max_pathway_size = 500L,
  source = "custom"
)
}
\arguments{
\item{mapping}{A \code{data.frame} with at least \code{gene_id} and
\code{pathway_id} columns. An optional \code{weight} column (numeric)
will be used as mask values instead of binary 1s.}

\item{feature_genes}{Optional character vector of gene IDs present in the
expression matrix. If supplied, the mask rows are restricted and ordered
to match these genes exactly. Genes not in the mapping receive all-zero
rows (no pathway membership). This is CRITICAL for aligning the mask
with the columns of a SummarizedExperiment assay.}

\item{min_pathway_size}{Integer. Pathways with fewer than this many genes
(after intersection with \code{feature_genes}) are dropped. Default 5.}

\item{max_pathway_size}{Integer. Pathways with more than this many genes
are dropped to reduce noise from overly broad terms. Default 500.}

\item{source}{Character label for the ontology source. Default "custom".}
}
\value{
A validated \code{GenePathwayMap} object.
}
\description{
Converts a two-column (or multi-column) data.frame of gene-pathway
associations into a sparse binary mask and a validated \code{GenePathwayMap}
S4 object.
}
\details{
\subsection{The Biology-to-Matrix Pipeline}{

The key idea is straightforward:

\preformatted{
  Gene-Pathway Table          Sparse Mask (dgCMatrix)
  +---------+------------+     Pathways:  P1  P2  P3
  | gene_id | pathway_id |     Gene_A  [  1   0   1 ]
  +---------+------------+     Gene_B  [  1   1   0 ]
  | Gene_A  | P1         |     Gene_C  [  0   1   0 ]
  | Gene_A  | P3         |     Gene_D  [  0   0   0 ]  <- not in any pathway
  | Gene_B  | P1         |
  | Gene_B  | P2         |
  | Gene_C  | P2         |
  +---------+------------+
}

Pitfalls this function handles:
\enumerate{
\item \strong{ID Mismatch}: Gene IDs in the mapping (e.g., Entrez) may
not match the feature IDs in your expression data (e.g., Ensembl).
Convert beforehand with \code{harmonizeGeneIds()}.
\item \strong{Duplicate Entries}: Many-to-many mappings (one gene in
multiple pathways) are valid and preserved; exact-duplicate rows are
silently collapsed.
\item \strong{Pathway Size Filtering}: Very small or very large pathways
add noise. Filtered by \code{min/max_pathway_size}.
\item \strong{Feature Alignment}: The mask rows MUST correspond 1:1 to
the features (rows) of the expression matrix. The
\code{feature_genes} argument enforces this alignment.
}
}
}
\examples{
mapping_df <- data.frame(
    gene_id    = c("ENSG001", "ENSG001", "ENSG002", "ENSG003"),
    pathway_id = c("KEGG_P53", "KEGG_APOPTOSIS", "KEGG_P53", "KEGG_APOPTOSIS")
)
features <- c("ENSG001", "ENSG002", "ENSG003", "ENSG004")
gpm <- buildGenePathwayMap(mapping_df, feature_genes = features,
    min_pathway_size = 1)
}
